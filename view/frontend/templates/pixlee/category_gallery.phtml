<?php
/**
 * Copyright Â© Pixlee TurnTo, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */
/* @var \Magento\Catalog\Block\Category\View $block */
/* @var \Magento\Framework\Escaper $escaper */
/* @var \Pixlee\Pixlee\ViewModel\ProductWidget $viewModel */
$viewModel = $block->getViewModel();
$nativeCategoryId = $block->getCurrentCategory()->getId();
?>
<?php if ($viewModel->isActive() && !empty($viewModel->getCDPWidgetId())) : ?>
    <div id="pixlee_container"></div>
    <div id="pixlee_widget_master_container"></div>

    <script type="text/x-magento-init">
        {
            "*": {
                "Pixlee_Pixlee/js/catalog-widget":{
                    "apiKey": "<?= $escaper->escapeJs($viewModel->getApiKey()) ?>",
                    "widgetId": <?= $escaper->escapeJs($viewModel->getCDPWidgetId()) ?>,
                    "nativeCategoryId": <?= $escaper->escapeJs($nativeCategoryId) ?>
                }
            }
        }
    </script>
<?php endif; ?>
